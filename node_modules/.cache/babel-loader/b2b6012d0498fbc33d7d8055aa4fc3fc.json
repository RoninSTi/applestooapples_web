{"ast":null,"code":"import _defineProperty from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/craigcronin/Development/applestooapples_web_template/src/views/chat/ChatView/RecentThreads/index.js\";\n\nimport React, { useState } from 'react';\nimport clsx from 'clsx';\nimport { useHistory } from 'react-router-dom';\nimport PerfectScrollbar from 'react-perfect-scrollbar';\nimport { makeStyles } from '@material-ui/core';\nimport axios from 'src/utils/axios';\nimport Search from './Search';\nimport ThreadList from './ThreadList';\nvar useStyles = makeStyles(function () {\n  return {\n    hideThreadList: {\n      display: 'none'\n    }\n  };\n});\n\nvar RecentThreads = function RecentThreads() {\n  var classes = useStyles();\n  var history = useHistory();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isSearchFocused = _useState2[0],\n      setSearchFocused = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      searchQuery = _useState4[0],\n      setSearchQuery = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      searchResults = _useState6[0],\n      setSearchResults = _useState6[1];\n\n  var handleSearchClickAway = function handleSearchClickAway() {\n    setSearchFocused(false);\n    setSearchQuery('');\n  };\n\n  var handleSearchChange = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var value, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              event.persist();\n              value = event.target.value;\n              setSearchQuery(value);\n\n              if (!value) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 7;\n              return axios.get('/api/chat/search', {\n                params: {\n                  query: value\n                }\n              });\n\n            case 7:\n              response = _context.sent;\n              setSearchResults(response.data.results);\n              _context.next = 12;\n              break;\n\n            case 11:\n              setSearchResults([]);\n\n            case 12:\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(_context.t0);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 14]]);\n    }));\n\n    return function handleSearchChange(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleSearchFocus = function handleSearchFocus(event) {\n    event.persist();\n    setSearchFocused(true);\n  };\n\n  var handleSearchSelect = function handleSearchSelect(result) {\n    setSearchFocused(false);\n    setSearchQuery('');\n    history.push(\"/app/chat/\".concat(result.username));\n  };\n\n  return /*#__PURE__*/React.createElement(PerfectScrollbar, {\n    options: {\n      suppressScrollX: true\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Search, {\n    isFocused: isSearchFocused,\n    onChange: handleSearchChange,\n    onClickAway: handleSearchClickAway,\n    onFocus: handleSearchFocus,\n    onSelect: handleSearchSelect,\n    query: searchQuery,\n    results: searchResults,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(ThreadList, {\n    className: clsx(_defineProperty({}, classes.hideThreadList, isSearchFocused)),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default RecentThreads;","map":{"version":3,"sources":["/Users/craigcronin/Development/applestooapples_web_template/src/views/chat/ChatView/RecentThreads/index.js"],"names":["React","useState","clsx","useHistory","PerfectScrollbar","makeStyles","axios","Search","ThreadList","useStyles","hideThreadList","display","RecentThreads","classes","history","isSearchFocused","setSearchFocused","searchQuery","setSearchQuery","searchResults","setSearchResults","handleSearchClickAway","handleSearchChange","event","persist","value","target","get","params","query","response","data","results","console","error","handleSearchFocus","handleSearchSelect","result","push","username","suppressScrollX"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport clsx from 'clsx';\nimport { useHistory } from 'react-router-dom';\nimport PerfectScrollbar from 'react-perfect-scrollbar';\nimport { makeStyles } from '@material-ui/core';\nimport axios from 'src/utils/axios';\nimport Search from './Search';\nimport ThreadList from './ThreadList';\n\nconst useStyles = makeStyles(() => ({\n  hideThreadList: {\n    display: 'none'\n  }\n}));\n\nconst RecentThreads = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [isSearchFocused, setSearchFocused] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n\n  const handleSearchClickAway = () => {\n    setSearchFocused(false);\n    setSearchQuery('');\n  };\n\n  const handleSearchChange = async (event) => {\n    try {\n      event.persist();\n\n      const { value } = event.target;\n\n      setSearchQuery(value);\n\n      if (value) {\n        const response = await axios.get('/api/chat/search', {\n          params: {\n            query: value\n          }\n        });\n\n        setSearchResults(response.data.results);\n      } else {\n        setSearchResults([]);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleSearchFocus = (event) => {\n    event.persist();\n    setSearchFocused(true);\n  };\n\n  const handleSearchSelect = (result) => {\n    setSearchFocused(false);\n    setSearchQuery('');\n    history.push(`/app/chat/${result.username}`);\n  };\n\n  return (\n    <PerfectScrollbar options={{ suppressScrollX: true }}>\n      <Search\n        isFocused={isSearchFocused}\n        onChange={handleSearchChange}\n        onClickAway={handleSearchClickAway}\n        onFocus={handleSearchFocus}\n        onSelect={handleSearchSelect}\n        query={searchQuery}\n        results={searchResults}\n      />\n      <ThreadList className={clsx({ [classes.hideThreadList]: isSearchFocused })} />\n    </PerfectScrollbar>\n  );\n};\n\nexport default RecentThreads;\n"]},"metadata":{},"sourceType":"module"}