{"ast":null,"code":"import _extends from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _toConsumableArray from \"/Users/craigcronin/Development/applestooapples_web_template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/craigcronin/Development/applestooapples_web_template/src/views/chat/ChatView/Thread/ComposeHeader.js\";\n\nimport React, { useState, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { Avatar, Box, Chip, ClickAwayListener, Input, List, ListItem, ListItemAvatar, ListItemText, Paper, Popper, Typography, makeStyles } from '@material-ui/core';\nimport axios from 'src/utils/axios';\n\nvar getFilteredSearchResults = function getFilteredSearchResults(results, recipients) {\n  var recipientIds = recipients.reduce(function (acc, recipient) {\n    return [].concat(_toConsumableArray(acc), [recipient.id]);\n  }, []);\n  return results.filter(function (result) {\n    return !recipientIds.includes(result.id);\n  });\n};\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      alignItems: 'center',\n      display: 'flex',\n      padding: theme.spacing(2)\n    },\n    container: {\n      marginLeft: theme.spacing(1)\n    },\n    recipient: {\n      marginLeft: 4,\n      marginRight: 4\n    },\n    input: {\n      backgroundColor: theme.palette.background.default,\n      borderRadius: 16,\n      height: 32,\n      paddingLeft: theme.spacing(2),\n      paddingRight: theme.spacing(2)\n    },\n    compactInput: {\n      maxWidth: 120\n    },\n    searchResults: {\n      marginTop: theme.spacing(1),\n      maxWidth: '100%',\n      width: 320\n    }\n  };\n});\n\nvar ComposeHeader = function ComposeHeader(_ref) {\n  var className = _ref.className,\n      onAddRecipient = _ref.onAddRecipient,\n      onRemoveRecipient = _ref.onRemoveRecipient,\n      recipients = _ref.recipients,\n      rest = _objectWithoutProperties(_ref, [\"className\", \"onAddRecipient\", \"onRemoveRecipient\", \"recipients\"]);\n\n  var classes = useStyles();\n  var containerRef = useRef(null);\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      query = _useState2[0],\n      setQuery = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isSearchFocused = _useState4[0],\n      setSearchFocused = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      searchResults = _useState6[0],\n      setSearchResults = _useState6[1];\n\n  var filteredSearchResults = getFilteredSearchResults(searchResults, recipients);\n  var displayResults = query && isSearchFocused;\n\n  var handleSearchChange = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var value, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              event.persist();\n              value = event.target.value;\n              setQuery(value);\n\n              if (!value) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 7;\n              return axios.get('/api/chat/search', {\n                params: {\n                  query: value\n                }\n              });\n\n            case 7:\n              response = _context.sent;\n              setSearchResults(response.data.results);\n              _context.next = 12;\n              break;\n\n            case 11:\n              setSearchResults([]);\n\n            case 12:\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(_context.t0);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 14]]);\n    }));\n\n    return function handleSearchChange(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSearchBlur = function handleSearchBlur(event) {\n    event.persist();\n\n    if (!displayResults) {\n      setSearchFocused(false);\n    }\n  };\n\n  var handleSearchFocus = function handleSearchFocus(event) {\n    event.persist();\n    setSearchFocused(true);\n  };\n\n  var handleSearchResultsClickAway = function handleSearchResultsClickAway() {\n    setSearchFocused(false);\n  };\n\n  var handleAddRecipient = function handleAddRecipient(contact) {\n    setQuery('');\n\n    if (onAddRecipient) {\n      onAddRecipient(contact);\n    }\n  };\n\n  var handleRemoveRecipient = function handleRemoveRecipient(recipientId) {\n    if (onRemoveRecipient) {\n      onRemoveRecipient(recipientId);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className)\n  }, rest, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"body1\",\n    color: \"textSecondary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }, \"To:\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container,\n    ref: containerRef,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }, recipients.map(function (recipient) {\n    return /*#__PURE__*/React.createElement(Chip, {\n      className: classes.recipient,\n      color: \"primary\",\n      key: recipient.id,\n      label: recipient.name,\n      onDelete: function onDelete() {\n        return handleRemoveRecipient(recipient.id);\n      },\n      size: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }\n    });\n  }), /*#__PURE__*/React.createElement(Input, {\n    className: clsx(classes.input, _defineProperty({}, classes.compactInput, recipients.length > 0)),\n    disableUnderline: true,\n    onBlur: handleSearchBlur,\n    onChange: handleSearchChange,\n    onFocus: handleSearchFocus,\n    placeholder: recipients.length === 0 ? 'Search contacts' : '',\n    value: query,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }\n  })), displayResults && /*#__PURE__*/React.createElement(ClickAwayListener, {\n    onClickAway: handleSearchResultsClickAway,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Popper, {\n    anchorEl: containerRef.current,\n    open: isSearchFocused,\n    placement: \"bottom-start\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    className: classes.searchResults,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, filteredSearchResults.length === 0 ? /*#__PURE__*/React.createElement(Box, {\n    pb: 2,\n    pt: 2,\n    px: 2,\n    textAlign: \"center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    color: \"textPrimary\",\n    gutterBottom: true,\n    variant: \"h4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 19\n    }\n  }, \"Nothing Found\"), /*#__PURE__*/React.createElement(Typography, {\n    color: \"textSecondary\",\n    variant: \"body2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 19\n    }\n  }, \"We couldn't find any matches for \\\"\", query, \"\\\". Try checking for typos or using complete words.\")) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Box, {\n    px: 2,\n    pt: 2,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    color: \"textSecondary\",\n    variant: \"h6\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 21\n    }\n  }, \"Contacts\")), /*#__PURE__*/React.createElement(List, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 19\n    }\n  }, filteredSearchResults.map(function (result) {\n    return /*#__PURE__*/React.createElement(ListItem, {\n      button: true,\n      key: result.id,\n      onClick: function onClick() {\n        return handleAddRecipient(result);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(ListItemAvatar, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Avatar, {\n      src: result.avatar,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(ListItemText, {\n      primary: result.name,\n      primaryTypographyProps: {\n        color: 'textPrimary',\n        noWrap: true,\n        variant: 'h6'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 25\n      }\n    }));\n  })))))));\n};\n\nComposeHeader.propTypes = {\n  className: PropTypes.string,\n  onAddRecipient: PropTypes.func,\n  onRemoveRecipient: PropTypes.func,\n  recipients: PropTypes.array\n};\nComposeHeader.defaultProps = {\n  onAddRecipient: function onAddRecipient() {},\n  onRemoveRecipient: function onRemoveRecipient() {},\n  recipients: []\n};\nexport default ComposeHeader;","map":{"version":3,"sources":["/Users/craigcronin/Development/applestooapples_web_template/src/views/chat/ChatView/Thread/ComposeHeader.js"],"names":["React","useState","useRef","PropTypes","clsx","Avatar","Box","Chip","ClickAwayListener","Input","List","ListItem","ListItemAvatar","ListItemText","Paper","Popper","Typography","makeStyles","axios","getFilteredSearchResults","results","recipients","recipientIds","reduce","acc","recipient","id","filter","result","includes","useStyles","theme","root","alignItems","display","padding","spacing","container","marginLeft","marginRight","input","backgroundColor","palette","background","default","borderRadius","height","paddingLeft","paddingRight","compactInput","maxWidth","searchResults","marginTop","width","ComposeHeader","className","onAddRecipient","onRemoveRecipient","rest","classes","containerRef","query","setQuery","isSearchFocused","setSearchFocused","setSearchResults","filteredSearchResults","displayResults","handleSearchChange","event","persist","value","target","get","params","response","data","console","error","handleSearchBlur","handleSearchFocus","handleSearchResultsClickAway","handleAddRecipient","contact","handleRemoveRecipient","recipientId","map","name","length","current","avatar","color","noWrap","variant","propTypes","string","func","array","defaultProps"],"mappings":"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","sourcesContent":["import React, {\n  useState,\n  useRef\n} from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport {\n  Avatar,\n  Box,\n  Chip,\n  ClickAwayListener,\n  Input,\n  List,\n  ListItem,\n  ListItemAvatar,\n  ListItemText,\n  Paper,\n  Popper,\n  Typography,\n  makeStyles\n} from '@material-ui/core';\nimport axios from 'src/utils/axios';\n\nconst getFilteredSearchResults = (results, recipients) => {\n  const recipientIds = recipients.reduce((acc, recipient) => {\n    return [...acc, recipient.id];\n  }, []);\n\n  return results.filter((result) => !recipientIds.includes(result.id));\n};\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    alignItems: 'center',\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  container: {\n    marginLeft: theme.spacing(1)\n  },\n  recipient: {\n    marginLeft: 4,\n    marginRight: 4\n  },\n  input: {\n    backgroundColor: theme.palette.background.default,\n    borderRadius: 16,\n    height: 32,\n    paddingLeft: theme.spacing(2),\n    paddingRight: theme.spacing(2)\n  },\n  compactInput: {\n    maxWidth: 120\n  },\n  searchResults: {\n    marginTop: theme.spacing(1),\n    maxWidth: '100%',\n    width: 320\n  }\n}));\n\nconst ComposeHeader = ({\n  className,\n  onAddRecipient,\n  onRemoveRecipient,\n  recipients,\n  ...rest\n}) => {\n  const classes = useStyles();\n  const containerRef = useRef(null);\n  const [query, setQuery] = useState('');\n  const [isSearchFocused, setSearchFocused] = useState(true);\n  const [searchResults, setSearchResults] = useState([]);\n\n  const filteredSearchResults = getFilteredSearchResults(searchResults, recipients);\n  const displayResults = query && isSearchFocused;\n\n  const handleSearchChange = async (event) => {\n    try {\n      event.persist();\n\n      const { value } = event.target;\n  \n      setQuery(value);\n\n      if (value) {\n        const response = await axios.get('/api/chat/search', {\n          params: {\n            query: value\n          }\n        });\n    \n        setSearchResults(response.data.results);\n      } else {\n        setSearchResults([]);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleSearchBlur = (event) => {\n    event.persist();\n\n    if (!displayResults) {\n      setSearchFocused(false);\n    }\n  };\n\n  const handleSearchFocus = (event) => {\n    event.persist();\n    setSearchFocused(true);\n  };\n\n  const handleSearchResultsClickAway = () => {\n    setSearchFocused(false);\n  };\n\n  const handleAddRecipient = (contact) => {\n    setQuery('');\n\n    if (onAddRecipient) {\n      onAddRecipient(contact);\n    }\n  };\n\n  const handleRemoveRecipient = (recipientId) => {\n    if (onRemoveRecipient) {\n      onRemoveRecipient(recipientId);\n    }\n  };\n\n  return (\n    <div\n      className={clsx(classes.root, className)}\n      {...rest}\n    >\n      <Typography\n        variant=\"body1\"\n        color=\"textSecondary\"\n      >\n        To:\n      </Typography>\n      <div\n        className={classes.container}\n        ref={containerRef}\n      >\n        {recipients.map((recipient) => (\n          <Chip\n            className={classes.recipient}\n            color=\"primary\"\n            key={recipient.id}\n            label={recipient.name}\n            onDelete={() => handleRemoveRecipient(recipient.id)}\n            size=\"small\"\n          />\n        ))}\n        <Input\n          className={clsx(classes.input, { [classes.compactInput]: recipients.length > 0 })}\n          disableUnderline\n          onBlur={handleSearchBlur}\n          onChange={handleSearchChange}\n          onFocus={handleSearchFocus}\n          placeholder={recipients.length === 0 ? 'Search contacts' : ''}\n          value={query}\n        />\n      </div>\n      {displayResults && (\n        <ClickAwayListener onClickAway={handleSearchResultsClickAway}>\n          <Popper\n            anchorEl={containerRef.current}\n            open={isSearchFocused}\n            placement=\"bottom-start\"\n          >\n            <Paper className={classes.searchResults}>\n              {filteredSearchResults.length === 0 ? (\n                <Box\n                  pb={2}\n                  pt={2}\n                  px={2}\n                  textAlign=\"center\"\n                >\n                  <Typography\n                    color=\"textPrimary\"\n                    gutterBottom\n                    variant=\"h4\"\n                  >\n                    Nothing Found\n                  </Typography>\n                  <Typography\n                    color=\"textSecondary\"\n                    variant=\"body2\"\n                  >\n                    We couldn&apos;t find any matches for &quot;\n                    {query}\n                    &quot;. Try checking for typos or using complete words.\n                  </Typography>\n                </Box>\n              ) : (\n                <>\n                  <Box\n                    px={2}\n                    pt={2}\n                  >\n                    <Typography\n                      color=\"textSecondary\"\n                      variant=\"h6\"\n                    >\n                      Contacts\n                    </Typography>\n                  </Box>\n                  <List>\n                    {filteredSearchResults.map((result) => (\n                      <ListItem\n                        button\n                        key={result.id}\n                        onClick={() => handleAddRecipient(result)}\n                      >\n                        <ListItemAvatar>\n                          <Avatar src={result.avatar} />\n                        </ListItemAvatar>\n                        <ListItemText\n                          primary={result.name}\n                          primaryTypographyProps={{\n                            color: 'textPrimary',\n                            noWrap: true,\n                            variant: 'h6'\n                          }}\n                        />\n                      </ListItem>\n                    ))}\n                  </List>\n                </>\n              )}\n            </Paper>\n          </Popper>\n        </ClickAwayListener>\n      )}\n    </div>\n  );\n};\n\nComposeHeader.propTypes = {\n  className: PropTypes.string,\n  onAddRecipient: PropTypes.func,\n  onRemoveRecipient: PropTypes.func,\n  recipients: PropTypes.array\n};\n\nComposeHeader.defaultProps = {\n  onAddRecipient: () => { },\n  onRemoveRecipient: () => { },\n  recipients: []\n};\n\nexport default ComposeHeader;\n"]},"metadata":{},"sourceType":"module"}